[TOC]



# HCIA 网络工程技术

+ AR——企业网用
+ S企业网用——二层、三层交换机
+ CE——数据中心 核心 堆叠 集群 虚拟化
+ NE——核心路由器 
+ MEE——广电、传媒



# 网络通信协议

## OSI

### 七层

+ 物理层
  + 在设备之间传输比特流，规定了电平、速度和电缆针脚
  + 看得见摸得着的网络设备：网线、光纤、猫HUB
+ 数据链路层
  + 将比特组合成字节，再将字节组合成帧，使用链路层地址（以太网使用MAC地址）来访问介质，并进行差错检测
  + 交换机、MAC地址、
+ 网络层
  + 提供逻辑地址，供路由器确定路径
+ 传输层
  + 提供面向连接或非面向连接的数据传递以及进行重传前的差错检测
+ 会话层
  + 负责建立、管理和终止表示层实体之间的通信会话。该层的通信由不同的设备中的应用程序之间的服务请求和响应组成
+ 表示层
  + 提供各种用于应用层数据的编码和转换功能，确保一个系统的应用层发送的数据能被另一个系统的应用层识别
+ 应用层
  + OSI参考模型中最靠近用户的一层，为应用程序提供网络服务

网络工程师：物理层、数据链路层、网络层、传输层

程序员：会话层、表示层、应用层



## TCP/IP协议

+ 网络接口层
+ 网络层
+ 传输层
+ 应用层



以太网的MAC地址由两部分组成，分别是供应商代码和序列号。其中前24为代表供应商代码，由IEEE管理和分配，剩下24位序列号由厂商自己分配

![image-20220925190648464](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220925190648464.png)





# 交换机

## 工作原理

+ 交换机接收端口与源数据地址的MAC建立一张二元组的MAC地址表

  <img src="HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/6NKvuihJqsOXVWZ.png" alt="Snipaste_2022-09-27_18-26-06.png" style="zoom:50%;" />

  + 交换机MAC地址表的维护：再次从同一接口接收到相同MAC地址为源MAC地址的数据帧，它就用新的时间来更新这个MAC地址条目

  + 在老化时间之内，没有通过这个接口再次接收到这个MAC地址发来的数据帧，它就会将这个老化的条目从自己的MAC地址表中删除

    + 查看MAC地址表老化时间

      ```
      display mac-address aging-time
      ```

    + 修改MAC地址表老化时间

      ```
      mac-address aging-time xx
      ```

  + 交换机MAC地址表的静态创建

    + 静态添加的MAC地址条目优先级高于交换机通过自己的接口动态学习到的条目

      + 静态添加静态MAC地址条目

        ```
        mac-address static xxxx-xxxx-xxxx g1/1 vlan 1
        ```

        

+ 目的MAC在主机的MAC地址表中，则从对应接口转发，否则向所有端口转发（flood）

+ 交换机接收到广播帧或组播帧则向所有端口转发





+ 交换机接收到一个单播数据帧时会查看其二层头部信息
  + 需要用数据的源MAC地址与其他相关信息来填充自己的MAC地址表
  + 为了查看数据帧的目的MAC地址，并且根据数据帧的目的MAC地址来查找自己的MAC地址表



+ 交换机查找MAC地址表结果对数据帧进行处理分三方面

  + 泛洪（Flooding）：交换机没有在自己的MAC地址表中找到这个数据帧的目的MAC地址

    ![image-20220927185418887](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220927185418887.png)

    + PC1向PC3发送数据，PC1数据通过线路到达交换机，交换机的MAC地址表中已有PC1MAC地址，不需要再创建。但是交换机没有数据帧的目的地址（PC3），所以交换机向除PC1外的接口都转发一份

  + 转发（Forwarding）：交换机的MAC地址表中拥有这个数据帧的目的MAC地址，且其对应的接口并不接收到这个数据帧的接口

    <img src="HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220927190140852.png" alt="image-20220927190140852" style="zoom: 67%;" />

  + 丢弃（Discarding）：交换机的MAC地址表中拥有这个数据帧的目的MAC地址，且其对应的接口正是接收到这个数据帧的接口

    <img src="HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220927190115726.png" alt="image-20220927190115726" style="zoom: 67%;" />





## 交换机的工作特点的利弊

1. 交换机可以实现即插即用
2. 恶意用户可以利用交换机的工作原理发起网络攻击
3. 通信数据在局域网里没有私密性





# VLAN

## 虚拟局域网（VLAN）技术

+ 通过逻辑手段重新分配物理资源的虚拟化技术
+ 通过逻辑手段，将某些特定的设备组成一个广播域
+ 无需考虑这些设备连接的是否是同一台交换机



## VLAN用途

1. 解决随着广播域增大而来的性能和安全性降低的问题
2. 逻辑上把一个物理局域网分隔为多个广播域
3. 每个广播域称为一个虚拟的局域网



## 特点

1. 每台网络终端设备只能属于一个VLAN，但是一个VLAN可以有多个终端
2. 属于同一个VLAN的设备之间可以通过二层直接通信
3. 属于不同VLAN的设备之间只能通过IP路由功能才能够实现通信



## 原理

+ VLAN技术会通过数据帧插入不同的VLAN标签

+ 交换机通过VLAN标签分辨出各个数据帧所属的VLAN

  



![image-20220927204715015](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220927204715015.png)



+ 没有携带VLAN标签（Tag）的数据帧

![image-20220927205123962](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220927205123962.png)

+ 携带VLAN标签的数据帧

![image-20220927205228045](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220927205228045.png)

+ VLAN的标签字段
  + TPID（标签协议标识符）
  + TCI（标签控制信息）
    + 优先级（Priority）
    + CFI（规范格式指示器）
    + VLAN ID（VLAN标识符）



## 多VLAN环境下交换机工作机制

+ 交换机接收到广播数据帧时，它只会将这个数据帧从除了该数据帧入站端口之外，其他同VLAN的所有端口发送出去
+ 交换机接收到一个目的MAC地址不存在于自己MAC地址表中的单播数据帧时，它只会将这个数据帧从除了该数据帧入站端口之外，其他同VLAN的端口发送出去



## WLAN的工作原理概述

+ 在不借助路由转发的大前提下，交换机不会将从一个VLAN的端口中接收到的数据帧，转发给任何其他VLAN中的端口



## 跨交换机VLAN原理

+ PVID
  + 无标记帧的VLAN ID
  + 是管理员给交换机接口配置的参数
  + 默认值为1



### 交换机接口类型

![image-20220927211531455](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220927211531455.png)

+ Acess接口，通常用于连接终端设备
+ Trunk接口，通常用于交换机之间互联



### 交换机Access接口的工作特点

+ 收到数据帧时，为数据帧打上VLAN标签
+ 发送数据帧时，移除VLAN标签



### 交换机Trunk接口的工作特点

+ 收到数据帧时，保留原有数据帧的VLAN标签
+ 发送数据帧时，为了让对端设备能够区分自己发出流量所在的VLAN而携带VLAN标签

- 例外：当交换机需要从Trunk接口发送的数据帧VLAN标签与这个Trunk接口的PVID相同，交换机会以不携带VLAN标签的方式来发送这个数据帧



### 交换机原理补充

+ 收到未知的单播帧，向本VLAN所有的非接收端口泛洪
+ 收到未知的单播帧，也会向所有Trunk接口泛洪



### 实验

![image-20220927215740082](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220927215740082.png)

1. `sy`进入系统视图

2. `sysname SW1`将交换机改名为SW1

3. `display vlan`查看vlan状况

   ![image-20220927220036154](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220927220036154.png)

4. `vlan 10 vlan 20`创建vlan10和vlan20

   ![image-20220927220147324](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220927220147324.png)

5. `interface g0/0/1`进入GE0/0/1接口

6. `port link-type access`设置接口类型为access

7. `port default vlan 10`将接口连接到vlan10

8. 将GE0/0/2按上述操作接入vlan20

9. `display vlan`

   ![image-20220927220716187](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220927220716187.png)

10. 设置trunk类型接口

    ```
    interface g0/0/10
    port link-type trunk
    port trunk allow-pass vlan 10 20 运行vlan10 20通过
    ```

11. `di this`查看接口和接口类型

    ![image-20220927221319283](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220927221319283.png)

12. 将其他设备进行相同的配置





# 冗余性和STP

冗余性可以增加网络的可用性，但可能形成一个封闭的信息环路给通信带来毁灭性的影响。

## 冗余链路

+ 冗余设备和链路解决网络的单点故障

  ![image-20220928102922708](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220928102922708.png)



## 冗余给网络带来的隐患

+ 重复帧

+ MAC地址震荡

  ![image-20220928103405366](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220928103405366.png)

+ 广播风暴

  ![image-20220928103508181](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220928103508181.png)

  

## STP

### 作用：在冗余链路的网络环境下

+ 去除单点故障的同时保证每个节点可达
+ 打破网络中的逻辑环路，阻断广播帧的循环广播



### 由来

![image-20220928104132385](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220928104132385.png)



### 工作原理

+ 根据一些规则判断出哪些端口能够转发数据，哪些端口不能转发数据
+ 不能转发数据的端口将它禁用起来
+ 实时监控各个端口和链路的状态。当出现故障时，STP会启用一些被禁用的端口



### 工作流程

1. 选取根网桥
   - 每个STP网络中都有且只有一台根网桥（亦称根交换机）
   - 作为根网桥的这台交换机就是STO所构建的生成树的根
   - 选举范围为整个交换网络
2. 选举根端口
   - 非交换机会在自己的所有端口之间，选择出距离根网桥最近的端口
   - 选举范围为每个交换机（除根交换局）
3. 选举指定端口
   - 位于同一网段中的所有端口之间选择出一个距离根网桥最近的端口 
   - 选举范围为每个网段
4. 阻塞预备端口
   + 在选出了根端口和指定端口后，STP会把那些既不是根端口，也不是指定端口的其他所有端口置于阻塞状态



#### 1.根网桥的选举

+ 参选者：在一个STP网络中，默认所有交换机都会参与根网桥的选举
+ 选举原则：在选取根网桥时，交换机之间相互对比的参数是”桥ID“

![image-20220928110730183](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220928110730183.png)

![image-20220928110818313](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220928110818313.png)



##### 桥ID的定义

- 优先级：16bit字段，默认为32768
- MAC地址：48bit字段，交换机的硬件MAC地址
- 由优先级和MAC地址组成一个64bit的字段



##### 根网桥的选举规则

- 首先，比较优先级，优先级小者优先
-  其次，比MAC地址，MAC地址小者优先



### 2.根端口（RP）的选举

+ 选举的范围是每台非根交换机
+ 参选者的是这台非根交换机上所有启用的端口



#### 选举原则

1. 选择根路径开销（Root Path Cost，RPC）最低的端口

   ![image-20220928112531734](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220928112531734.png)

2. 若有多个端口RPC相等，选择对端桥ID最低的端口（BID）

   ![image-20220928112812535](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220928112812535.png)

3. 若有多个端口的对端桥ID相等，选择对端端口ID最低的端口（PID=端口号+优先级128）

   ![image-20220928112944317](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220928112944317.png)



### 3.指定端口（DP）的选举

+ 选举的范围是每个网段
+ 参选者是同处于这个网段中的所有端口（不包括已经被选举为根端口的端口）



#### 选举原则

1. 选择根路径开销（Root Path Cost，RPC）最低的端口

2. 若有多个端口的RPC相等，选择桥ID最低的端口（本端）

3. 若有多个端口桥ID相等，选择端口ID最低的端口（本端）

![image-20220928113850127](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220928113850127.png)



### 4.阻塞剩余端口



### 交换机端口角色归纳

+ 根端口：非根桥上距离根桥最近的端口，处于转发状态
+ 指定端口：每一个网段中距离根最近的端口，处于转发状态
+ 预备端口：落选的端口，处于监听状态



![image-20220928114305332](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220928114305332.png)

预备端口接收BPDU，检测其他线路是否存在问题。



# RSTP

+ STP的收敛速度特点
  + 端口从阻塞状态过渡到转发状态，转发延迟就会消耗30秒
  + 发送故障时，处于阻塞状态的端口无法收到BPDU，它默认会等待20秒，也就是等待MaxAge计算器超时，才会触发交换机重新计算STP

![image-20220928115048201](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220928115048201.png)

+ RSTP特点
  + 取消和修改了STP标准中定义的某些端口状态
  + 定义了几个新的端口角色和一些可以让端口直接由阻塞状态过渡到转发状态的情形
  + 减少了交换机等待根交换机发送CBPDU的时间（6s）

### 端口角色

+ 根端口（RP）
+ 指定端口（DP）
+ 预备端口（AP）
+ 备份端口（Backup Port，BP）



#### 预备端口与备份端口比较

+ 预备端口（AP）和备份端口（BP）在拓扑完成收敛后都会被RSTP阻塞
+ 端口接收到更优BPDU是由其他网桥转发过来的，代表这个端口为预备端口
+ 端口接收到的更优BPDU是本网桥发送到，代表这个端口为备份端口

![image-20220928120853607](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220928120853607.png)



### 边缘端口

![image-20220928121332177](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220928121332177.png)



## PSTP中的P/A机制

+ 工作于非边缘的点到点的端口类型
+ 选择让指定端口于链路对端进行握手，并逐级传递的方式来避免环路
+ 完成握手的RSTP指定端口即可直接过渡到转发状态，而不需要经历任何涉及计算器的过渡状态







# 路由基础

路由（routing）指的是中间设备（比如路由器）通过查找路由表对数据包进行转发的处理方式



## MAC地址与IP地址对比

+ 都可以用来定位设备
+ MAC地址工作与数据链路层，而IP地址工作于网络层
+ MAC地址是物理地址，而IP地址是逻辑地址
+ MAC地址随载体移动，而IP地址不随载体移动



## 网络设备建立转发数据库的方式

+ 把自己各个接口所在的子网记录进转发数据库
+ 直接向设备的转发数据库中输入向某些子网转发数据的路径
+ 相互学习彼此转发数据库中的数据转发路径



## 路由相关概念

+ 路由表（Routing Table）等价于转发数据库
+ 路由表中”路由条目“等价于转发数据的路径



## 路由器的转发数据工作原理

+ 路由表是路由器赖以转发数据包的数据库
+ 用数据包的目的IP地址去匹配路由表中的路由条目
+ 根据匹配条目的路由参数决定任何转发这个数据库



## 路由表的查看命令

+ 查看IPv4路由表的摘要信息

  ```
  [Router]display ip routing-table
  ```

+ 在命令尾部加上参数verbose可查看路由表的详细信息

  ```
  [Router]display ip routing-table verbose
  ```

  

## 路由信息的三种来源

+ 直连路由：只要来连接该网络的接口状态正常，无需多做配置，直连路由就会出现在路由表中
+ 静态路由：需要管理员通过命令手动添加到路由表中
+ 动态路由：通过路由协议从邻居路由器哪里学习过来的路由



## 路由优先级

+ 路由器给每种路由信息渠道赋予的一个权重，此权重值就叫路由优先级（亦称协议优先级）
+ 路由优先级值越小，代表这种话类型的路由可信度越高

![image-20220928150331920](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220928150331920.png)



## 路由度量值

+ 指去往目的网络的开销
+ 度量值越小越优先
+ 不同的路由协议参考计算度量值的因素不一样



## 1.直连路由

+ 路由会把状态正常的接口所连接的网络，作为直连路由放入自己的路由表中
+ 直连路由的路由优先级和度量值皆为0
+ 直连路由的路由优先级和度量值都是不可修改的

### 实例

![image-20220928151447527](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220928151447527.png)

+ AR1通过命令display ip interface brief查看接口状态

  ![image-20220928151536457](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220928151536457.png)

  ![image-20220928151648757](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220928151648757.png)

  ![image-20220928151704906](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220928151704906.png)

+ ![image-20220928151809254](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220928151809254.png)

+ ![image-20220928151826155](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220928151826155.png)

  



## 2.静态路由

- 手工配置去往目的网络的路径
- 默认值：有优先级（60）、度量值（0）
- 优先级可以通过命令修改



### 静态路由优先级的调配

+ 去往同一目的网络，优先级相同可以实现负载

  ![image-20220928193133736](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220928193133736.png)

- 去往同一网络，配置优先级不同则可以实现主备

  ![image-20220928193457171](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220928193457171.png)



#### 优点

+ 静态路由比动态路由更加稳定
+ 静态路由比动态路由更加可控
+ 静态路由比动态路由更加容易部署



#### 缺点

+ 静态路由的扩展性很差
+ 静态路由无法反映拓扑的变化



#### 静态路由配置

![image-20220928194338139](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220928194338139.png)

![image-20220928194552938](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220928194552938.png)



####  实验

![image-20220929110607992](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220929110607992.png)

AR4

![image-20220929110815908](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220929110815908.png)

AR3，AR2

![image-20220929111043545](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220929111043545.png)



#### 配置方法

![image-20220929111444511](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20220929111444511.png)

+ Trunk口（点到点线路上）可以用以上所有的配置方法
+ GE口
  + 指向下一跳
  + 指向出接口和下一跳





### 默认路由

+ 默认路由实际上是一种特殊的静态路由



#### 概述

+ 最长匹配原则（选路由）
  + 当多条路由均匹配数据包的目的IP地址时，路由器会按照掩码最长的，也就是最精确的那条路由来转发这个数据包
  + 一条全0路由可以匹配以任何IP地址作为目的地址的数据包



+ 默认路由
  + 掩码长度全为0的静态路由称为默认路由
  + 通常用于目标网络地址不明的路由配置



#### 应用场景

![image-20221004174819630](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20221004174819630.png)



#### 配置方法

![image-20221004174839361](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20221004174839361.png)







# 三层交换技术

如果一台交换机可以集成三层路由的功能，那么它在同一个VLAN中的主机提供基于MAC地址的数据帧转发，还可以在内部消化掉整个VLAN间路由所需的三层数据包转发



## 概述

### 二层交换机的特征

+ 旨在连接同构网络的设备
+ 第一个来自于某个源MAC地址的数据帧，会改变交换机此后的转发行为
+ 根据目的MAC是否匹配MAC地址表以及该条目是否是数据帧的入站接口作出转发、泛洪和丢弃的决策
+ 交换操作（switching）是一项高度程式化的固定流程



### 路由器特征

+ 旨在连接异构网络的设备
+ 必须在各层支持大量不同的协议和标准
+ 路由器相互学习路由和根据最长匹配原则来判断数据包出站接口的过程远比交接机执行交换操作的逻辑要复杂得多



### 三层交换机

+ 集成了三层数据包转发功能的交换机被称为三层交换机
+ 可以实现将终端隔离在不同VLAN中，同时为这些终端提供VLAN间路的功能
+ 随着通过ASIC（和网络处理器）开始大量应用于路由器，路由器和交换机中间的界限已经变得十分模糊



#### 三层交换机配置

1. 创建VLAN并且根据设计方案将各个接口划分到不同的VLAN的配置与二层交换机一致

2. 路由部分的配置方法和命令根路由器的配置相差无几

3. 三层交换机需要解决接口分配三层IP地址的配置，否则不具备称为终端网关设备的能力

   

#### 虚拟VLAN接口

- 简称SVI接口
- 它们所在的网段作为直连路由填充在路由表中
- 虚拟VLAN接口就十分适合充当该VLAN所连接设备的网关

![image-20221004191945757](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20221004191945757.png)

![image-20221004192023816](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20221004192023816.png)

![image-20221004192148996](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20221004192148996.png)

![image-20221004192204478](HCIA%20%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF.assets/image-20221004192204478.png)



#### 、





# 动态路由

## 静态路由和动态路由协议对比

+ 相对于静态路由，动态路由协议更适合于大规模网络环境中的理由
  + 动态路由协议的扩展性强
    + 就配置而言，随着网络规模的增加，配置静态路由的难度也会随之加大
    + 而配置动态路由，则只需要宣告路由器的直连网段，相对简化得多
  + 动态路由协议具备应变能力
+ 







































































